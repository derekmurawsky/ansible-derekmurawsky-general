{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"derekmurawsky.general ansible collection This collection contains some roles and playbooks that I use to set up and maintain my homelab. An overview of the playbooks and roles is below, with more details in the relevant documentation sections. Playbooks All playbooks in this bundle target all hosts by default. You can target specific hosts by passing -e 'target=hostname-or-group' on the command line to override this behavior. Bootstrap A very simple playbook that will use the collections bootstrap role to bootstrap all targeted hosts for ansible management. Proxmox A simple playbook that will apply the proxmox roles from this collection to all targeted hosts. Roles ansible_bootstrap A role to help bootstrap a linux server for ansible management. It provisions a user, adds the user to the sudoers group, and configures password-less sudo for that user. proxmox_base A role that does some baseline configuration on a proxmox server. It adds the pve-no-subscription repo, updates the cache, and puts vmbr0 vlan-aware. proxmox_nginx A role that configures nginx as a reverse proxy on the proxmox server. It installs and configures nginx as a reverse proxy pointing to the proxmox server behind it. It utilizes ProxMox's default certificates.","title":"Home"},{"location":"#derekmurawskygeneral-ansible-collection","text":"This collection contains some roles and playbooks that I use to set up and maintain my homelab. An overview of the playbooks and roles is below, with more details in the relevant documentation sections.","title":"derekmurawsky.general ansible collection"},{"location":"#playbooks","text":"All playbooks in this bundle target all hosts by default. You can target specific hosts by passing -e 'target=hostname-or-group' on the command line to override this behavior.","title":"Playbooks"},{"location":"#bootstrap","text":"A very simple playbook that will use the collections bootstrap role to bootstrap all targeted hosts for ansible management.","title":"Bootstrap"},{"location":"#proxmox","text":"A simple playbook that will apply the proxmox roles from this collection to all targeted hosts.","title":"Proxmox"},{"location":"#roles","text":"","title":"Roles"},{"location":"#ansible_bootstrap","text":"A role to help bootstrap a linux server for ansible management. It provisions a user, adds the user to the sudoers group, and configures password-less sudo for that user.","title":"ansible_bootstrap"},{"location":"#proxmox_base","text":"A role that does some baseline configuration on a proxmox server. It adds the pve-no-subscription repo, updates the cache, and puts vmbr0 vlan-aware.","title":"proxmox_base"},{"location":"#proxmox_nginx","text":"A role that configures nginx as a reverse proxy on the proxmox server. It installs and configures nginx as a reverse proxy pointing to the proxmox server behind it. It utilizes ProxMox's default certificates.","title":"proxmox_nginx"},{"location":"ADRs/","text":"Architectural Decision Log This log lists the architectural decisions for [project name]. ADR-0000 - Use Markdown Architectural Decision Records ADR-0001 - Use MKDocs, MKDocs-Material, and MKDocs-Monorepo for documentation For new ADRs, please use adr-template.md as basis. More information on MADR is available at https://adr.github.io/madr/ . General information about architectural decision records is available at https://adr.github.io/ .","title":"ADRs"},{"location":"ADRs/#architectural-decision-log","text":"This log lists the architectural decisions for [project name]. ADR-0000 - Use Markdown Architectural Decision Records ADR-0001 - Use MKDocs, MKDocs-Material, and MKDocs-Monorepo for documentation For new ADRs, please use adr-template.md as basis. More information on MADR is available at https://adr.github.io/madr/ . General information about architectural decision records is available at https://adr.github.io/ .","title":"Architectural Decision Log"},{"location":"ADRs/0000-use-markdown-architectural-decision-records/","text":"Use Markdown Architectural Decision Records Context and Problem Statement We want to record architectural decisions made in this project. Which format and structure should these records follow? Considered Options MADR 2.1.2 \u2013 The Markdown Architectural Decision Records Michael Nygard's template \u2013 The first incarnation of the term \"ADR\" Sustainable Architectural Decisions \u2013 The Y-Statements Other templates listed at https://github.com/joelparkerhenderson/architecture_decision_record Formless \u2013 No conventions for file format and structure Decision Outcome Chosen option: \"MADR 2.1.2\", because Implicit assumptions should be made explicit. Design documentation is important to enable people understanding the decisions later on. See also A rational design process: How and why to fake it . The MADR format is lean and fits our development style. The MADR structure is comprehensible and facilitates usage & maintenance. The MADR project is vivid. Version 2.1.2 is the latest one available when starting to document ADRs.","title":"Use Markdown Architectural Decision Records"},{"location":"ADRs/0000-use-markdown-architectural-decision-records/#use-markdown-architectural-decision-records","text":"","title":"Use Markdown Architectural Decision Records"},{"location":"ADRs/0000-use-markdown-architectural-decision-records/#context-and-problem-statement","text":"We want to record architectural decisions made in this project. Which format and structure should these records follow?","title":"Context and Problem Statement"},{"location":"ADRs/0000-use-markdown-architectural-decision-records/#considered-options","text":"MADR 2.1.2 \u2013 The Markdown Architectural Decision Records Michael Nygard's template \u2013 The first incarnation of the term \"ADR\" Sustainable Architectural Decisions \u2013 The Y-Statements Other templates listed at https://github.com/joelparkerhenderson/architecture_decision_record Formless \u2013 No conventions for file format and structure","title":"Considered Options"},{"location":"ADRs/0000-use-markdown-architectural-decision-records/#decision-outcome","text":"Chosen option: \"MADR 2.1.2\", because Implicit assumptions should be made explicit. Design documentation is important to enable people understanding the decisions later on. See also A rational design process: How and why to fake it . The MADR format is lean and fits our development style. The MADR structure is comprehensible and facilitates usage & maintenance. The MADR project is vivid. Version 2.1.2 is the latest one available when starting to document ADRs.","title":"Decision Outcome"},{"location":"ADRs/0001-use-mkdocs-monorepo/","text":"Use MKDocs, MKDocs-Material, and MKDocs-Monorepo for documentation Status: accepted Deciders: Derek Murawsky Date: 2/17/2022 Technical Story: Documentation is key for many reasons chief among them being that I will forget how I did this in a year. Context and Problem Statement As a human who forgets things, including where I documented something, I need to have clear documentation available in the same repo as the code that it documents. Decision Drivers Markdown is easy, and used in most project by default I already know MKDocs I want to learn MKDocs Monorepo for much of the work I do professionally Considered Options MKDocs with Material & Monorepo Plain Old Readmes with Markdown Decision Outcome Chosen option: MKDocs with Material Positive Consequences It's really quite good looking and fairly simple to implement. I can generate a separate website and host it with github pages easily. Negative Consequences It's more complicated than Plain Old Readmes Links MKDocs MKDocs Material MKDocs Monorepo plugin.","title":"Use MKDocs, MKDocs-Material, and MKDocs-Monorepo for documentation"},{"location":"ADRs/0001-use-mkdocs-monorepo/#use-mkdocs-mkdocs-material-and-mkdocs-monorepo-for-documentation","text":"Status: accepted Deciders: Derek Murawsky Date: 2/17/2022 Technical Story: Documentation is key for many reasons chief among them being that I will forget how I did this in a year.","title":"Use MKDocs, MKDocs-Material, and MKDocs-Monorepo for documentation"},{"location":"ADRs/0001-use-mkdocs-monorepo/#context-and-problem-statement","text":"As a human who forgets things, including where I documented something, I need to have clear documentation available in the same repo as the code that it documents.","title":"Context and Problem Statement"},{"location":"ADRs/0001-use-mkdocs-monorepo/#decision-drivers","text":"Markdown is easy, and used in most project by default I already know MKDocs I want to learn MKDocs Monorepo for much of the work I do professionally","title":"Decision Drivers"},{"location":"ADRs/0001-use-mkdocs-monorepo/#considered-options","text":"MKDocs with Material & Monorepo Plain Old Readmes with Markdown","title":"Considered Options"},{"location":"ADRs/0001-use-mkdocs-monorepo/#decision-outcome","text":"Chosen option: MKDocs with Material","title":"Decision Outcome"},{"location":"ADRs/0001-use-mkdocs-monorepo/#positive-consequences","text":"It's really quite good looking and fairly simple to implement. I can generate a separate website and host it with github pages easily.","title":"Positive Consequences"},{"location":"ADRs/0001-use-mkdocs-monorepo/#negative-consequences","text":"It's more complicated than Plain Old Readmes","title":"Negative Consequences"},{"location":"ADRs/0001-use-mkdocs-monorepo/#links","text":"MKDocs MKDocs Material MKDocs Monorepo plugin.","title":"Links "},{"location":"ADRs/adr-template/","text":"{short title of solved problem and solution} Status: {proposed | rejected | accepted | deprecated | \u2026 | superseded by ADR-0005 } Deciders: {list everyone involved in the decision} Date: {YYYY-MM-DD when the decision was last updated} Technical Story: {description | ticket/issue URL} Context and Problem Statement {Describe the context and problem statement, e.g., in free form using two to three sentences. You may want to articulate the problem in form of a question.} Decision Drivers {driver 1, e.g., a force, facing concern, \u2026} {driver 2, e.g., a force, facing concern, \u2026} \u2026 Considered Options {option 1} {option 2} {option 3} \u2026 Decision Outcome Chosen option: \"{option 1}\", because {justification. e.g., only option, which meets k.o. criterion decision driver | which resolves force {force} | \u2026 | comes out best (see below)}. Positive Consequences {e.g., improvement of quality attribute satisfaction, follow-up decisions required, \u2026} \u2026 Negative Consequences {e.g., compromising quality attribute, follow-up decisions required, \u2026} \u2026 Pros and Cons of the Options {option 1} {example | description | pointer to more information | \u2026} Good, because {argument a} Good, because {argument b} Bad, because {argument c} \u2026 {option 2} {example | description | pointer to more information | \u2026} Good, because {argument a} Good, because {argument b} Bad, because {argument c} \u2026 {option 3} {example | description | pointer to more information | \u2026} Good, because {argument a} Good, because {argument b} Bad, because {argument c} \u2026 Links {Link type} {Link to ADR} \u2026","title":"{short title of solved problem and solution}"},{"location":"ADRs/adr-template/#short-title-of-solved-problem-and-solution","text":"Status: {proposed | rejected | accepted | deprecated | \u2026 | superseded by ADR-0005 } Deciders: {list everyone involved in the decision} Date: {YYYY-MM-DD when the decision was last updated} Technical Story: {description | ticket/issue URL}","title":"{short title of solved problem and solution}"},{"location":"ADRs/adr-template/#context-and-problem-statement","text":"{Describe the context and problem statement, e.g., in free form using two to three sentences. You may want to articulate the problem in form of a question.}","title":"Context and Problem Statement"},{"location":"ADRs/adr-template/#decision-drivers","text":"{driver 1, e.g., a force, facing concern, \u2026} {driver 2, e.g., a force, facing concern, \u2026} \u2026","title":"Decision Drivers "},{"location":"ADRs/adr-template/#considered-options","text":"{option 1} {option 2} {option 3} \u2026","title":"Considered Options"},{"location":"ADRs/adr-template/#decision-outcome","text":"Chosen option: \"{option 1}\", because {justification. e.g., only option, which meets k.o. criterion decision driver | which resolves force {force} | \u2026 | comes out best (see below)}.","title":"Decision Outcome"},{"location":"ADRs/adr-template/#positive-consequences","text":"{e.g., improvement of quality attribute satisfaction, follow-up decisions required, \u2026} \u2026","title":"Positive Consequences "},{"location":"ADRs/adr-template/#negative-consequences","text":"{e.g., compromising quality attribute, follow-up decisions required, \u2026} \u2026","title":"Negative Consequences "},{"location":"ADRs/adr-template/#pros-and-cons-of-the-options","text":"","title":"Pros and Cons of the Options "},{"location":"ADRs/adr-template/#option-1","text":"{example | description | pointer to more information | \u2026} Good, because {argument a} Good, because {argument b} Bad, because {argument c} \u2026","title":"{option 1}"},{"location":"ADRs/adr-template/#option-2","text":"{example | description | pointer to more information | \u2026} Good, because {argument a} Good, because {argument b} Bad, because {argument c} \u2026","title":"{option 2}"},{"location":"ADRs/adr-template/#option-3","text":"{example | description | pointer to more information | \u2026} Good, because {argument a} Good, because {argument b} Bad, because {argument c} \u2026","title":"{option 3}"},{"location":"ADRs/adr-template/#links","text":"{Link type} {Link to ADR} \u2026","title":"Links "},{"location":"derekmurawsky-general-ansible-bootstrap-role/","text":"Ansible_Bootstrap A simple role to help bootstrap a linux server for ansible management. It provisions a user, adds the user to the sudoers group, and configures password-less sudo for that user. Requirements This role only requires a working ansible installation. However, the workflow can benefit from having the SSH askpass installed. See the example playbook below for why. Role Variables Variable Default Description bootstrap_user_name ansible The username for ansible to provision bootstrap_user_shell /bin/bash The shell for the user bootstrap_user_ssh_pubkey \"\" The ssh public key string to assign to the user bootstrap_user_sudo_group sudo The sudo group to add the user to Dependencies This role uses only builtin modules. Example Playbook Below is a simple playbook that can be called with any inventory to bootstrap a server with the public key of your current user. An example command would be ansible-playbook -i hosts.yaml --ask-pass bootstrap.yaml --- - hosts : all vars : bootstrap_user_ssh_pubkey : \"{{ lookup('file', '~/.ssh/id_rsa.pub') }}\" roles : - ansible_bootstrap","title":"Overview"},{"location":"derekmurawsky-general-ansible-bootstrap-role/#ansible_bootstrap","text":"A simple role to help bootstrap a linux server for ansible management. It provisions a user, adds the user to the sudoers group, and configures password-less sudo for that user.","title":"Ansible_Bootstrap"},{"location":"derekmurawsky-general-ansible-bootstrap-role/#requirements","text":"This role only requires a working ansible installation. However, the workflow can benefit from having the SSH askpass installed. See the example playbook below for why.","title":"Requirements"},{"location":"derekmurawsky-general-ansible-bootstrap-role/#role-variables","text":"Variable Default Description bootstrap_user_name ansible The username for ansible to provision bootstrap_user_shell /bin/bash The shell for the user bootstrap_user_ssh_pubkey \"\" The ssh public key string to assign to the user bootstrap_user_sudo_group sudo The sudo group to add the user to","title":"Role Variables"},{"location":"derekmurawsky-general-ansible-bootstrap-role/#dependencies","text":"This role uses only builtin modules.","title":"Dependencies"},{"location":"derekmurawsky-general-ansible-bootstrap-role/#example-playbook","text":"Below is a simple playbook that can be called with any inventory to bootstrap a server with the public key of your current user. An example command would be ansible-playbook -i hosts.yaml --ask-pass bootstrap.yaml --- - hosts : all vars : bootstrap_user_ssh_pubkey : \"{{ lookup('file', '~/.ssh/id_rsa.pub') }}\" roles : - ansible_bootstrap","title":"Example Playbook"},{"location":"derekmurawsky-general-playbooks/","text":"Playbooks The following playbooks are bundled with this collection. Note All playbooks in this bundle target all hosts by default. You can target specific hosts by passing -e 'target=hostname-or-group' on the command line to override this behavior. bootstrap A very simple playbook that will use the collections bootstrap role to bootstrap all targeted hosts for ansible management. Warning This playbook will use the ~/.ssh/id_rsa.pub key of the current user by default. You can also pass it a public key with -e 'pubkey=....' . host_facts This is a handy and simple playbook that will dump out all the facts available on a host. Especially handy when you save the output to a file. ansible-playbook derekmurawsky.general.host_facts -l host > facts.txt proxmox A simple playbook that will apply the proxmox roles from this collection to all targeted hosts.","title":"Overview"},{"location":"derekmurawsky-general-playbooks/#playbooks","text":"The following playbooks are bundled with this collection. Note All playbooks in this bundle target all hosts by default. You can target specific hosts by passing -e 'target=hostname-or-group' on the command line to override this behavior.","title":"Playbooks"},{"location":"derekmurawsky-general-playbooks/#bootstrap","text":"A very simple playbook that will use the collections bootstrap role to bootstrap all targeted hosts for ansible management. Warning This playbook will use the ~/.ssh/id_rsa.pub key of the current user by default. You can also pass it a public key with -e 'pubkey=....' .","title":"bootstrap"},{"location":"derekmurawsky-general-playbooks/#host_facts","text":"This is a handy and simple playbook that will dump out all the facts available on a host. Especially handy when you save the output to a file. ansible-playbook derekmurawsky.general.host_facts -l host > facts.txt","title":"host_facts"},{"location":"derekmurawsky-general-playbooks/#proxmox","text":"A simple playbook that will apply the proxmox roles from this collection to all targeted hosts.","title":"proxmox"},{"location":"derekmurawsky-general-proxmox-base-role/","text":"Proxmox base A simple role that does some baseline configuration on a proxmox server. It adds the pve-no-subscription repo, updates the cache, and puts vmbr0 vlan-aware. Requirements None Role Variables Variable Default Description proxmox_install_pve_no_subscription true If true, installs the pve_no_subscription repo. Dependencies community.general Example Playbook --- - hosts : proxmox_servers roles : - proxmox_base become : yes","title":"Overview"},{"location":"derekmurawsky-general-proxmox-base-role/#proxmox-base","text":"A simple role that does some baseline configuration on a proxmox server. It adds the pve-no-subscription repo, updates the cache, and puts vmbr0 vlan-aware.","title":"Proxmox base"},{"location":"derekmurawsky-general-proxmox-base-role/#requirements","text":"None","title":"Requirements"},{"location":"derekmurawsky-general-proxmox-base-role/#role-variables","text":"Variable Default Description proxmox_install_pve_no_subscription true If true, installs the pve_no_subscription repo.","title":"Role Variables"},{"location":"derekmurawsky-general-proxmox-base-role/#dependencies","text":"community.general","title":"Dependencies"},{"location":"derekmurawsky-general-proxmox-base-role/#example-playbook","text":"--- - hosts : proxmox_servers roles : - proxmox_base become : yes","title":"Example Playbook"},{"location":"derekmurawsky-general-proxmox-nginx-role/","text":"proxmox-nginx A role that configures nginx as a reverse proxy on the proxmox server. It installs and configures nginx as a reverse proxy pointing to the proxmox server behind it. It utilizes ProxMox's default certificates. Requirements None Role Variables Variable Default Description proxmox_nginx_ssl_certificate /etc/pve/local/pve-ssl.pem Path to the server certificate proxmox_nginx_ssl_certificate_key /etc/pve/local/pve-ssl.key Path to the server certificate key Dependencies None Example Playbook --- - hosts : proxmox_servers roles : - proxmox_nginx become : yes Useful links Proxmox nginx documentation","title":"Overview"},{"location":"derekmurawsky-general-proxmox-nginx-role/#proxmox-nginx","text":"A role that configures nginx as a reverse proxy on the proxmox server. It installs and configures nginx as a reverse proxy pointing to the proxmox server behind it. It utilizes ProxMox's default certificates.","title":"proxmox-nginx"},{"location":"derekmurawsky-general-proxmox-nginx-role/#requirements","text":"None","title":"Requirements"},{"location":"derekmurawsky-general-proxmox-nginx-role/#role-variables","text":"Variable Default Description proxmox_nginx_ssl_certificate /etc/pve/local/pve-ssl.pem Path to the server certificate proxmox_nginx_ssl_certificate_key /etc/pve/local/pve-ssl.key Path to the server certificate key","title":"Role Variables"},{"location":"derekmurawsky-general-proxmox-nginx-role/#dependencies","text":"None","title":"Dependencies"},{"location":"derekmurawsky-general-proxmox-nginx-role/#example-playbook","text":"--- - hosts : proxmox_servers roles : - proxmox_nginx become : yes","title":"Example Playbook"},{"location":"derekmurawsky-general-proxmox-nginx-role/#useful-links","text":"Proxmox nginx documentation","title":"Useful links"}]}